<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>Mission Control â€” OpenClaw Dashboard</title>
<style>
  :root { --bg: #0d1117; --card: #161b22; --border: #30363d; --text: #c9d1d9; --text-dim: #8b949e; --accent: #58a6ff; --green: #3fb950; --yellow: #d29922; --red: #f85149; }
  * { margin: 0; padding: 0; box-sizing: border-box; }
  body { font-family: -apple-system, BlinkMacSystemFont, 'Segoe UI', sans-serif; background: var(--bg); color: var(--text); padding: 20px; max-width: 1200px; margin: 0 auto; }
  .header { text-align: center; margin-bottom: 30px; }
  .title { font-size: 2em; font-weight: 700; }
  .subtitle { color: var(--text-dim); font-size: 0.9em; margin-top: 4px; }
  .grid { display: grid; grid-template-columns: 1fr 1fr; gap: 20px; }
  @media (max-width: 768px) { .grid { grid-template-columns: 1fr; } }
  .card { background: var(--card); border: 1px solid var(--border); border-radius: 8px; padding: 16px; }
  .card h2 { font-size: 1.1em; margin-bottom: 12px; color: var(--accent); }
  .card.full { grid-column: 1 / -1; }
  .goal { margin-bottom: 12px; padding-bottom: 12px; border-bottom: 1px solid var(--border); }
  .goal:last-child { border-bottom: none; margin-bottom: 0; padding-bottom: 0; }
  .goal-name { font-weight: 600; font-size: 1em; }
  .goal-status { display: inline-block; padding: 2px 8px; border-radius: 12px; font-size: 0.75em; margin-left: 8px; }
  .status-active { background: rgba(63, 185, 80, 0.2); color: var(--green); }
  .status-tracking { background: rgba(210, 153, 34, 0.2); color: var(--yellow); }
  .status-planned { background: rgba(139, 148, 158, 0.2); color: var(--text-dim); }
  .sub-goals { margin-top: 6px; padding-left: 16px; }
  .sub-goal { color: var(--text-dim); font-size: 0.85em; margin: 2px 0; }
  .activity { margin-bottom: 8px; font-size: 0.85em; }
  .activity-date { color: var(--accent); font-size: 0.8em; }
  .activity-title { font-weight: 600; }
  .fact { margin-bottom: 10px; }
  .fact-heading { font-weight: 600; color: var(--accent); font-size: 0.9em; }
  .fact-content { color: var(--text-dim); font-size: 0.8em; white-space: pre-wrap; margin-top: 2px; }
  .stats { display: flex; gap: 20px; justify-content: center; margin: 16px 0; }
  .stat { text-align: center; }
  .stat-value { font-size: 1.8em; font-weight: 700; color: var(--accent); }
  .stat-label { font-size: 0.75em; color: var(--text-dim); }
  .empty { color: var(--text-dim); font-style: italic; font-size: 0.85em; }
  .generated { text-align: center; color: var(--text-dim); font-size: 0.75em; margin-top: 20px; }
</style>
</head>
<body>
<div class="header">
  <div class="title">ðŸŽ¯ Mission Control</div>
  <div class="subtitle" id="subtitle">OpenClaw Dashboard</div>
</div>

<div class="stats" id="stats"></div>

<div class="grid">
  <div class="card full" id="goals-card">
    <h2>ðŸŽ¯ Goals</h2>
    <div id="goals"><span class="empty">No goals found. Add .md files to memory/goals/ and run generate-data.mjs</span></div>
  </div>
  <div class="card" id="activity-card">
    <h2>ðŸ“‹ Recent Activity</h2>
    <div id="activities"><span class="empty">No activity yet.</span></div>
  </div>
  <div class="card" id="facts-card">
    <h2>ðŸ§  Key Facts</h2>
    <div id="facts"><span class="empty">No key facts. Populate MEMORY.md.</span></div>
  </div>
</div>

<div class="generated" id="generated"></div>

<script>
const data = window.__DASHBOARD_DATA__ || null;
if (data) {
  document.getElementById('subtitle').textContent = `OpenClaw Dashboard â€” ${data.owner}`;
  
  // Stats
  const statsEl = document.getElementById('stats');
  const stats = [
    { value: data.stats.totalGoals, label: 'Goals' },
    { value: data.stats.activeGoals, label: 'Active' },
    { value: data.stats.totalActivities, label: 'Activities' },
  ];
  statsEl.innerHTML = stats.map(s => `<div class="stat"><div class="stat-value">${s.value}</div><div class="stat-label">${s.label}</div></div>`).join('');

  // Goals
  const goals = [...(data.goals || []), ...(data.lifeGoals || []), ...(data.additionalGoals || [])];
  if (goals.length > 0) {
    document.getElementById('goals').innerHTML = goals.map(g => `
      <div class="goal">
        <span class="goal-name">${g.emoji || 'ðŸŽ¯'} ${g.name}</span>
        <span class="goal-status status-${g.status}">${g.status}</span>
        ${g.subGoals && g.subGoals.length > 0 ? `<div class="sub-goals">${g.subGoals.slice(0, 5).map(s => `<div class="sub-goal">â€¢ ${s.title}</div>`).join('')}</div>` : ''}
      </div>
    `).join('');
  }

  // Activities
  if (data.activities && data.activities.length > 0) {
    document.getElementById('activities').innerHTML = data.activities.slice(0, 20).map(a => `
      <div class="activity">
        <span class="activity-date">${a.date}</span>
        <span class="activity-title">${a.title}</span>
        <div style="color:var(--text-dim);font-size:0.8em">${a.desc}</div>
      </div>
    `).join('');
  }

  // Key Facts
  if (data.keyFacts && data.keyFacts.length > 0) {
    document.getElementById('facts').innerHTML = data.keyFacts.slice(0, 10).map(f => `
      <div class="fact">
        <div class="fact-heading">${f.heading}</div>
        <div class="fact-content">${f.content.slice(0, 300)}${f.content.length > 300 ? '...' : ''}</div>
      </div>
    `).join('');
  }

  document.getElementById('generated').textContent = `Last updated: ${new Date(data.generated).toLocaleString()}`;
} else {
  document.getElementById('generated').textContent = 'No data. Run: node mission-control/generate-data.mjs';
}
</script>
</body>
</html>
